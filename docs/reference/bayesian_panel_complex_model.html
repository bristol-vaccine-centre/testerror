<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Uses resampling to incorporate uncertainty of sensitivity and specificity
into an estimate of true prevalence from a given value of apparent
prevalence."><title>Bayesian models true prevalence for panel — bayesian_panel_complex_model • testerror</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bayesian models true prevalence for panel — bayesian_panel_complex_model"><meta property="og:description" content="Uses resampling to incorporate uncertainty of sensitivity and specificity
into an estimate of true prevalence from a given value of apparent
prevalence."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">testerror</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/testerror.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/bayesian-panel-tests.html">Bayesian adjustment of panel test error</a>
    <a class="dropdown-item" href="../articles/beta-distributions.html">Working with Beta distributions</a>
    <a class="dropdown-item" href="../articles/panel-tests.html">Panel test error adjustment</a>
    <a class="dropdown-item" href="../articles/single-test.html">Single test error adjustment</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/bristol-vaccine-centre/testerror/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Bayesian models true prevalence for panel</h1>
      <small class="dont-index">Source: <a href="https://github.com/bristol-vaccine-centre/testerror/blob/HEAD/R/bayesian_panel_complex_model.R" class="external-link"><code>R/bayesian_panel_complex_model.R</code></a></small>
      <div class="d-none name"><code>bayesian_panel_complex_model.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Uses resampling to incorporate uncertainty of sensitivity and specificity
into an estimate of true prevalence from a given value of apparent
prevalence.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bayesian_panel_complex_model</span><span class="op">(</span></span>
<span>  test_results <span class="op">=</span> <span class="fu">testerror</span><span class="fu">:::</span><span class="va">.input_data</span>,</span>
<span>  false_pos_controls <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_controls <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  false_neg_diseased <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_diseased <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  sens <span class="op">=</span> <span class="fu"><a href="uniform_prior.html">uniform_prior</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  spec <span class="op">=</span> <span class="fu"><a href="uniform_prior.html">uniform_prior</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  panel_sens <span class="op">=</span> <span class="fu"><a href="uniform_prior.html">uniform_prior</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  panel_spec <span class="op">=</span> <span class="fu"><a href="uniform_prior.html">uniform_prior</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  panel_name <span class="op">=</span> <span class="st">"Panel"</span>,</span>
<span>  confint <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  fmt <span class="op">=</span> <span class="st">"%1.2f%% [%1.2f%% — %1.2f%%]"</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  warmup <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">2000</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>test_results</dt>
<dd><p>A dataframe containing the following columns:</p><ul><li><p>id (character) - the patient identifier</p></li>
<li><p>result (logical) - the test result</p></li>
<li><p>test (factor) - the test type</p></li>
</ul><p>Ungrouped</p></dd>


<dt>false_pos_controls</dt>
<dd><p>the number of positives that appeared in the specificity
disease-free control group. These are by definition false positives. This
is (1-specificity)*n_controls</p></dd>


<dt>n_controls</dt>
<dd><p>the number of controls in the specificity
disease-free control group.</p></dd>


<dt>false_neg_diseased</dt>
<dd><p>the number of negatives that appeared in the sensitivity
confirmed disease group. These are by definition false negatives. This
is (1-sensitivity)*n_diseased</p></dd>


<dt>n_diseased</dt>
<dd><p>the number of confirmed disease cases in the sensitivity
control group.</p></dd>


<dt>...</dt>
<dd><p>not used</p></dd>


<dt>sens</dt>
<dd><p>the prior sensitivity of the test as a <code>beta_dist</code>.</p></dd>


<dt>spec</dt>
<dd><p>the prior specificity of the test as a <code>beta_dist</code>.</p></dd>


<dt>panel_sens</dt>
<dd><p>the prior sensitivity of the panel as a <code>beta_dist</code>
(optional)</p></dd>


<dt>panel_spec</dt>
<dd><p>the prior specificity of the panel as a <code>beta_dist</code>
(optional)</p></dd>


<dt>panel_name</dt>
<dd><p>the name of the panel for combined result</p></dd>


<dt>confint</dt>
<dd><p>confidence interval limits</p></dd>


<dt>fmt</dt>
<dd><p>a <code>sprintf</code> formatting string accepting 3 numbers</p></dd>


<dt>chains</dt>
<dd><p>A positive integer specifying the number of Markov chains. 
    The default is 4.</p></dd>


<dt>warmup</dt>
<dd><p>A positive integer specifying the number of warmup (aka burnin)
    iterations per chain. If step-size adaptation is on (which it is by default), 
    this also controls the number of iterations for which adaptation is run (and
    hence these warmup samples should not be used for inference). The number of 
    warmup iterations should be smaller than <code>iter</code> and the default is
    <code>iter/2</code>.</p></dd>


<dt>iter</dt>
<dd><p>A positive integer specifying the number of iterations for each 
    chain (including warmup). The default is 2000.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>a list of dataframes containing the prevalence, sensitivity, and
specificity estimates, and a <code>stanfit</code> object with the raw fit data</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This is not vectorised</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Robert Challen.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

