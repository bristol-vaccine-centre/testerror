[{"path":"https://bristol-vaccine-centre.github.io/testerror/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2023 Bristol vaccine centre Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/articles/bayesian-panel-tests.html","id":"binaxnow-test-results","dir":"Articles","previous_headings":"","what":"BinaxNOW test results","title":"Bayesian adjustment of panel test error","text":"","code":"binax_pos = 26 binax_n = 786  # Fit beta distributions to sinclair 2013 data: # We apply a widening to increase uncertainty in sensitivity binax_sens = beta_params(median = 0.740, lower = 0.666, upper = 0.823, widen = 5) binax_spec = beta_params(median = 0.972, lower=  0.927, upper = 0.998)  tmp1 = testerror::bayesian_component_simpler_model(   pos_obs = binax_pos,   n_obs = binax_n,   sens = binax_sens,   spec = binax_spec,   method = \"bayes\" )  binax_summ = tmp1$summary %>%   dplyr::transmute(   Test = \"Binax\",   Positivity = sprintf(\"%d/%d (%1.2f%%)\", binax_pos, binax_n, binax_pos/binax_n*100),   `Estimated prevalence` = prevalence.label,   `Sensitivity` = sens.label,   `Specificity` = spec.label,   `Method` = prevalence.method   )  binax_summ %>% default_table()"},{"path":"https://bristol-vaccine-centre.github.io/testerror/articles/bayesian-panel-tests.html","id":"uad1-results","dir":"Articles","previous_headings":"","what":"UAD1 results","title":"Bayesian adjustment of panel test error","text":"description going assume count data panel components, limited information component tests. can use bayesian model construct adjusted estimates","code":"# data from Forstner et al (2019) components = tibble::tibble(   serotype = factor(c(\"1\", \"3\", \"4\", \"5\", \"6A\", \"6B\", \"7F\", \"9V\", \"14\", \"18C\", \"19A\", \"19F\", \"23F\")),   pos = c(2, 30, 2, 1, 4, 0, 7, 1, 1, 3, 2, 3, 4),   n = 796 )  uad1_pos = 59 uad1_n = 796  # control group data # negatives at  uad1_spec = beta_dist(shape1=1,shape2=1) %>%    # data from Pride et al   update_posterior(0,17)  # Datd from Pride et al uad1_controls = tibble::tibble(   serotype = factor(c(\"1\", \"3\", \"4\", \"5\", \"6A\", \"6B\", \"7F\", \"9V\", \"14\", \"18C\", \"19A\", \"19F\", \"23F\")),   false_neg_diseased = c(0L, 1L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L),   n_diseased = c(7, 1, 3, 1, 1, 0, 4, 2, 7, 0, 6, 0, 2),   # In the design of UAD1 the cut off is calibrated on 400 negative samples and    # set to make 2 positive      # In the control group of 397 non-CAP patients, 1 patient had to   # be excluded because of indeterminable results (0.3%, see Fig. 1)   # and SSUAD was positive in 3 patients (0.8%). Of those 3 non-CAP   # patients, 2 were positive for serotype 18C and 1 person for two   # pneumococcal serotypes (5, 7F).    false_pos_controls = 2+c(0L, 1L, 0L, 1L, 0L, 0L, 0L, 0L, 0L, 2L, 0L, 0L, 0L),   n_controls = 400+397 )   uad1_sens = beta_dist(shape1=1,shape2=1) %>%    # data from Pride et al   update_posterior(17,17) corr3 = testerror::bayesian_panel_simpler_model(   panel_pos_obs = uad1_pos,   panel_n_obs = uad1_n,   panel_name = \"PCV13\",      pos_obs = components$pos,   n_obs = components$n,   test_names = components$serotype,      false_pos_controls = uad1_controls$false_pos_controls,   n_controls = uad1_controls$n_controls,   false_neg_diseased = uad1_controls$false_neg_diseased,   n_diseased = uad1_controls$n_diseased,      panel_sens = uad1_sens ) corr3$summary %>%    mutate(     pos_obs = c(components$pos, uad1_pos),     n_obs = c(components$n, uad1_n)   ) %>%   dplyr::transmute(   Test = test,   Positivity = sprintf(\"%d/%d (%1.2f%%)\", pos_obs, n_obs, pos_obs/n_obs*100),   `Estimated prevalence` = prevalence.label,   `Sensitivity` = sens.label,   `Specificity` = spec.label,   `Method` = prevalence.method ) %>%    bind_rows(binax_summ) %>%   default_table() %>% huxtable::set_top_border(row = huxtable::final(2), col=huxtable::everywhere, value = 1)"},{"path":"https://bristol-vaccine-centre.github.io/testerror/articles/bayesian-panel-tests.html","id":"sensitivity-analysis-with-different-uad-test-parameters","dir":"Articles","previous_headings":"","what":"Sensitivity analysis with different UAD test parameters","title":"Bayesian adjustment of panel test error","text":"","code":"# senstivity / specificity from Kakiuchi et al   kak_uad1_sens = beta_params(median = 0.741, lower = 0.537, upper = 0.889) kak_uad1_spec = beta_params(median = 0.954, lower = 0.917, upper = 0.978) %>%    # data from Pride et al   update_posterior(17,17)  corr4 = testerror::bayesian_panel_simpler_model(   panel_pos_obs = uad1_pos,   panel_n_obs = uad1_n,   panel_name = \"PCV13\",      pos_obs = components$pos,   n_obs = components$n,   test_names = components$serotype,      false_pos_controls = uad1_controls$false_pos_controls,   n_controls = uad1_controls$n_controls,   false_neg_diseased = uad1_controls$false_neg_diseased,   n_diseased = uad1_controls$n_diseased,      panel_sens = kak_uad1_sens,   panel_spec = kak_uad1_spec )  corr4$summary %>%    mutate(     pos_obs = c(components$pos, uad1_pos),     n_obs = c(components$n, uad1_n)   ) %>%   dplyr::transmute(   Test = test,   Positivity = sprintf(\"%d/%d (%1.2f%%)\", pos_obs, n_obs, pos_obs/n_obs*100),   `Estimated prevalence` = prevalence.label,   `Sensitivity` = sens.label,   `Specificity` = spec.label,   `Method` = prevalence.method ) %>% bind_rows(   binax_summ ) %>%    default_table() %>% huxtable::set_top_border(row = huxtable::final(2), col=huxtable::everywhere, value = 1)"},{"path":"https://bristol-vaccine-centre.github.io/testerror/articles/single-test.html","id":"rogan-gladen-adjustment","dir":"Articles","previous_headings":"","what":"Rogan-gladen adjustment","title":"Single test error adjustment","text":"can use rogan-gladen adjustment estimate true prevalence know sensitivity specificity. However suffers truncation issue apparent prevalence outside range (1-spec) sens: also requires exact measure sensitivity specificity. reality hard obtain. associated paper discuss 3 methods accounting uncertainty sensitivity specificity estimating true prevalence apparent prevalence. lang-reiczigel method, resampling procedure combined rogan gladen estimates full bayesian model. illustrate look example BinaxNOW testing.","code":"rogan_gladen(0.125, 0.8, 0.95) #> [1] 0.1 rogan_gladen(0.05, 0.8, 0.95) #> [1] 0 rogan_gladen(0.8, 0.8, 0.95) #> [1] 1"},{"path":"https://bristol-vaccine-centre.github.io/testerror/articles/single-test.html","id":"binaxnow-example","dir":"Articles","previous_headings":"","what":"BinaxNOW Example","title":"Single test error adjustment","text":"case uncertain estimates sensitivity specificity literature, supplied median values 95% confidence intervals. assume underlying Beta distribution estimate uncertainty. demonstration purposes look true prevalence every value apparent prevalence 0 150 positives set 1000 tests, using 3 methods: Comparing 3 methods wide range apparent prevalence qualitatively shows different behaviour methods. Bayesian model seems appropriate prevalence low suffer truncation issue methods. however much slower.  figure rogan-gladen adjustment median sensitivity specificity red line (base), blue line shows case assuming test 100% sensitive specific. magenta cross point true prevalence equal apparent prevalence.","code":"# Fit beta distributions to sinclair 2013 data: sens = beta_params(median = 0.740, lower = 0.666, upper = 0.823) spec = beta_params(median = 0.972, lower=  0.927, upper = 0.998)  sens #> 0.746 [0.663–0.819] (N=118.15) spec #> 0.974 [0.926–0.995] (N=87.41) tmp1 = tibble::tibble(   observed = 0:150,   n = 1000 ) %>% dplyr::mutate(testerror::true_prevalence(   pos_obs = observed,   n_obs = n,   sens = sens,   spec = spec,   method = \"bayes\" ))  tmp2 = tibble::tibble(   observed = 0:150,   n = 1000 ) %>% dplyr::mutate(testerror::true_prevalence(   pos_obs = observed,   n_obs = n,   sens = sens,   spec = spec,   method = \"lang\" ))  tmp3 = tibble::tibble(   observed = 0:150,   n = 1000 ) %>% dplyr::mutate(testerror::true_prevalence(   pos_obs = observed,   n_obs = n,   sens = sens,   spec = spec,   method = \"rogan\" ))  tmp = dplyr::bind_rows(tmp1,tmp2,tmp3) thresh = testerror::underestimation_threshold(sens$q(0.5),spec$q(0.5)) N = unique(tmp$n)    ggplot(tmp, ggplot2::aes(y=observed/n, x=prevalence.median, xmin=prevalence.lower, xmax=prevalence.upper)) +   ggplot2::geom_point()+   ggplot2::geom_errorbarh(alpha=0.4)+   ggplot2::geom_point(data=tmp %>% dplyr::filter(observed==40), colour=\"orange\")+   ggplot2::geom_errorbarh(data=tmp %>% dplyr::filter(observed==40), colour=\"orange\", height=0)+   ggplot2::geom_abline(colour=\"blue\")+   ggplot2::geom_point(x=thresh,y=thresh,colour=\"magenta\", size=4, shape=10)+   ggplot2::geom_abline(intercept = 1-spec$q(0.5), slope = sens$q(0.5)-(1-spec$q(0.5)), colour=\"red\")+   ggplot2::scale_y_continuous(name=\"observed apparent prevalence\",sec.axis = ggplot2::sec_axis(trans = ~ .x*N,name = sprintf(\"count (N=%d)\",N)))+   ggplot2::labs(caption= sprintf(\"threshold value where true prevalence equals apparent prevalence: (%1.2f,%1.2f)\\nspecificity: %s\\nsensitivity: %s\",thresh,thresh,format(spec),format(sens)))+   ggplot2::xlab(\"estimated true prevalence\")+   ggplot2::facet_wrap(~prevalence.method)"},{"path":"https://bristol-vaccine-centre.github.io/testerror/articles/single-test.html","id":"test-uncertainty","dir":"Articles","previous_headings":"","what":"Test uncertainty","title":"Single test error adjustment","text":"example gold standard compare output . testing can generate simulation using sensitivity specificity using range simulated true prevalence. Applying correction simulated apparent prevalence allows us compare simulated gold standard. example distribution sensitivity specificity used estimate true prevalence used simulate “observed” data.  range “true” prevalences tested (0-20%) apparent prevalence ranges 0.25 17.5%. Adjusting test uncertainty 3 methods described gives point estimate near true prevalence (blue line) cases. Confidence intervals result uncertainty test performance metrics prevalence disease. shown fact width confidence correction improved increasing sample size (although accuracy central prediction ). Improving confidence predictions true prevalence can achieved better estimates test performance metrics.","code":"ex1 = testerror:::test_example(   spec = spec$shape1/spec$conc,   sens = sens$shape1/sens$conc,   n_samples = 5000,   n_controls = floor(spec$conc),   n_diseased = floor(sens$conc),   exact=TRUE )  res1 = ex1$summary %>% dplyr::mutate(true_prevalence(   pos_obs = observed_pos,   n_obs = n_samples,   false_pos_controls = ex1$performance$false_pos_controls,   n_controls = ex1$performance$n_controls,   false_neg_diseased = ex1$performanc$false_neg_diseased,   n_diseased = ex1$performance$n_diseased,   method = \"bayes\" ))  res2 = ex1$summary %>% dplyr::mutate(true_prevalence(   pos_obs = observed_pos,   n_obs = n_samples,   false_pos_controls = ex1$performance$false_pos_controls,   n_controls = ex1$performance$n_controls,   false_neg_diseased = ex1$performanc$false_neg_diseased,   n_diseased = ex1$performance$n_diseased,   method = \"lang-reiczigel\" ))  res3 = ex1$summary %>% dplyr::mutate(true_prevalence(   pos_obs = observed_pos,   n_obs = n_samples,   false_pos_controls = ex1$performance$false_pos_controls,   n_controls = ex1$performance$n_controls,   false_neg_diseased = ex1$performanc$false_neg_diseased,   n_diseased = ex1$performance$n_diseased,   method = \"rogan-gladen\" ))  testerror:::demo_bar_plot(dplyr::bind_rows(res1,res2,res3))+   ggplot2::labs(caption=sprintf(\"Red lines / grey bars are apparent prevalence / counts Blue lines the underlying true prevalence rate. Test sensitivity: %s Test specificity: %s \", format(sens), format(spec)))"},{"path":"https://bristol-vaccine-centre.github.io/testerror/articles/testerror.html","id":"correcting-panel-tests-for-test-error","dir":"Articles","previous_headings":"","what":"Correcting panel tests for test error","title":"Getting started","text":"define panel testing testing multiple subtypes disease, positive result subtype regarded positive disease. describe paper leads compound error, particularly significant individual components present low prevalence number components involved large. following example simulation population true prevalence 15%, tested using panel 15 tests sensitivity 0.99 specificity 0.8. individual components panel generate small amounts error compound test positivity (red) serious overestimate panel prevalence (blue). package provides modelled estimates prevalence test panel test positivity.  functions elaborated vignettes.","code":"tmp = testerror:::panel_example(   panel_prev = 0.15, comp_spec = 0.99,    comp_sens = 0.8, n_comp = 15, n_samples = 2000,    n_controls = 800, n_diseased = 30, exact_controls = TRUE) #, exact_samples = TRUE)  corr2 = true_panel_prevalence(    test_results = tmp$samples %>% dplyr::select(id,test,result = observed),    false_pos_controls = tmp$performance$false_pos_controls,    n_controls = tmp$performance$n_controls,    false_neg_diseased = tmp$performance$false_neg_diseased,    n_diseased = tmp$performance$n_diseased,    method = \"lang-reiczigel\"    #method = \"rogan-gladen\"    #method = \"bayes\" )  testerror:::demo_bar_plot(tmp$summary %>% dplyr::inner_join(bind_rows(corr2),by=\"test\"))"},{"path":"https://bristol-vaccine-centre.github.io/testerror/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Robert Challen. Author, maintainer.","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Challen R (2023). testerror: Uncertainty Multiplex Panel Testing. doi:10.5281/zenodo.7691196, https://github.com/bristol-vaccine-centre/testerror.","code":"@Manual{,   title = {testerror: Uncertainty in Multiplex Panel Testing},   year = {2023},   author = {Robert Challen},   url = {https://github.com/bristol-vaccine-centre/testerror},   doi = {https://doi.org/10.5281/zenodo.7691196}, }"},{"path":"https://bristol-vaccine-centre.github.io/testerror/index.html","id":"testerror","dir":"","previous_headings":"","what":"Uncertainty in Multiplex Panel Testing ","title":"Uncertainty in Multiplex Panel Testing ","text":"Simulations analytical approaches test uncertainty prevalence calculations development","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/apparent_prevalence.html","id":null,"dir":"Reference","previous_headings":"","what":"Apparent prevalence from known prevalence — apparent_prevalence","title":"Apparent prevalence from known prevalence — apparent_prevalence","text":"observed counts disease going binomial apparent prevalence probability. never less (1-specificity) test (never sensitivity). either quantities uncertain shape distribution observed counts clear cut.","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/apparent_prevalence.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Apparent prevalence from known prevalence — apparent_prevalence","text":"","code":"apparent_prevalence(p, sens, spec)"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/apparent_prevalence.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Apparent prevalence from known prevalence — apparent_prevalence","text":"p true value prevalence sens sensitivity test spec specificity test","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/apparent_prevalence.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Apparent prevalence from known prevalence — apparent_prevalence","text":"expected value apparent prevalence","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/apparent_prevalence.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Apparent prevalence from known prevalence — apparent_prevalence","text":"","code":"apparent_prevalence(0, 0.75, 0.97) #> [1] 0.03 apparent_prevalence(1, 0.75, 0.97) #> [1] 0.75"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/as_tibble.beta_dist.html","id":null,"dir":"Reference","previous_headings":"","what":"convert a beta distribution to a tibble — as_tibble.beta_dist","title":"convert a beta distribution to a tibble — as_tibble.beta_dist","text":"convert beta distribution tibble","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/as_tibble.beta_dist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"convert a beta distribution to a tibble — as_tibble.beta_dist","text":"","code":"# S3 method for beta_dist as_tibble(x, prefix = NULL, confint = 0.95, ...)"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/as_tibble.beta_dist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"convert a beta distribution to a tibble — as_tibble.beta_dist","text":"x beta distribution prefix name output columns prefix.lower, prefix.upper etc confint confidence intervals ... used","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/as_tibble.beta_dist_list.html","id":null,"dir":"Reference","previous_headings":"","what":"convert a list of betas to a tibble — as_tibble.beta_dist_list","title":"convert a list of betas to a tibble — as_tibble.beta_dist_list","text":"convert list betas tibble","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/as_tibble.beta_dist_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"convert a list of betas to a tibble — as_tibble.beta_dist_list","text":"","code":"# S3 method for beta_dist_list as_tibble(x, ...)"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/as_tibble.beta_dist_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"convert a list of betas to a tibble — as_tibble.beta_dist_list","text":"x beta dist list ... Arguments passed as_tibble.beta_dist prefix name output columns prefix.lower, prefix.upper etc confint confidence intervals","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/as_tibble.beta_dist_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"convert a list of betas to a tibble — as_tibble.beta_dist_list","text":"tibble","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/bayesian_component_simpler_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Bayesian simpler model true prevalence for component — bayesian_component_simpler_model","title":"Bayesian simpler model true prevalence for component — bayesian_component_simpler_model","text":"Bayesian simpler model true prevalence component","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/bayesian_component_simpler_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bayesian simpler model true prevalence for component — bayesian_component_simpler_model","text":"","code":"bayesian_component_simpler_model(   pos_obs,   n_obs,   false_pos_controls = NULL,   n_controls = NULL,   false_neg_diseased = NULL,   n_diseased = NULL,   ...,   sens = uniform_prior(),   spec = uniform_prior(),   confint = 0.95,   fmt = \"%1.2f%% [%1.2f%% — %1.2f%%]\",   chains = 4,   warmup = 1000,   iter = 2000 )"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/bayesian_component_simpler_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bayesian simpler model true prevalence for component — bayesian_component_simpler_model","text":"pos_obs vector number positive observations component test n_obs number observations given test false_pos_controls number positives appeared specificity disease-free control group. definition false positives. (1-specificity)*n_controls n_controls number controls specificity disease-free control group. false_neg_diseased number negatives appeared sensitivity confirmed disease group. definition false negatives. (1-sensitivity)*n_diseased n_diseased number confirmed disease cases sensitivity control group. ... used sens prior sensitivity test beta_dist. spec prior specificity test beta_dist. confint confidence interval limits fmt sprintf formatting string accepting 3 numbers chains positive integer specifying number Markov chains.      default 4. warmup positive integer specifying number warmup (aka burnin)     iterations per chain. step-size adaptation (default),      also controls number iterations adaptation run (    hence warmup samples used inference). number      warmup iterations smaller iter default     iter/2. iter positive integer specifying number iterations      chain (including warmup). default 2000.","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/bayesian_component_simpler_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bayesian simpler model true prevalence for component — bayesian_component_simpler_model","text":"list dataframes containing prevalence, sensitivity, specificity estimates, stanfit object raw fit data","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/bayesian_panel_complex_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Bayesian models true prevalence for panel — bayesian_panel_complex_model","title":"Bayesian models true prevalence for panel — bayesian_panel_complex_model","text":"Uses resampling incorporate uncertainty sensitivity specificity estimate true prevalence given value apparent prevalence.","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/bayesian_panel_complex_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bayesian models true prevalence for panel — bayesian_panel_complex_model","text":"","code":"bayesian_panel_complex_model(   test_results = testerror:::.input_data,   false_pos_controls = NULL,   n_controls = NULL,   false_neg_diseased = NULL,   n_diseased = NULL,   ...,   sens = uniform_prior(),   spec = uniform_prior(),   panel_sens = uniform_prior(),   panel_spec = uniform_prior(),   panel_name = \"Panel\",   confint = 0.95,   fmt = \"%1.2f%% [%1.2f%% — %1.2f%%]\",   chains = 4,   warmup = 1000,   iter = 2000 )"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/bayesian_panel_complex_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bayesian models true prevalence for panel — bayesian_panel_complex_model","text":"test_results dataframe containing following columns: id (character) - patient identifier result (logical) - test result test (factor) - test type Ungrouped false_pos_controls number positives appeared specificity disease-free control group. definition false positives. (1-specificity)*n_controls n_controls number controls specificity disease-free control group. false_neg_diseased number negatives appeared sensitivity confirmed disease group. definition false negatives. (1-sensitivity)*n_diseased n_diseased number confirmed disease cases sensitivity control group. ... used sens prior sensitivity test beta_dist. spec prior specificity test beta_dist. panel_sens prior sensitivity panel beta_dist (optional) panel_spec prior specificity panel beta_dist (optional) panel_name name panel combined result confint confidence interval limits fmt sprintf formatting string accepting 3 numbers chains positive integer specifying number Markov chains.      default 4. warmup positive integer specifying number warmup (aka burnin)     iterations per chain. step-size adaptation (default),      also controls number iterations adaptation run (    hence warmup samples used inference). number      warmup iterations smaller iter default     iter/2. iter positive integer specifying number iterations      chain (including warmup). default 2000.","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/bayesian_panel_complex_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bayesian models true prevalence for panel — bayesian_panel_complex_model","text":"list dataframes containing prevalence, sensitivity, specificity estimates, stanfit object raw fit data","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/bayesian_panel_complex_model.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Bayesian models true prevalence for panel — bayesian_panel_complex_model","text":"vectorised","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/bayesian_panel_simpler_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Bayesian simpler model true prevalence for panel — bayesian_panel_simpler_model","title":"Bayesian simpler model true prevalence for panel — bayesian_panel_simpler_model","text":"Bayesian simpler model true prevalence panel","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/bayesian_panel_simpler_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bayesian simpler model true prevalence for panel — bayesian_panel_simpler_model","text":"","code":"bayesian_panel_simpler_model(   panel_pos_obs,   panel_n_obs,   pos_obs,   n_obs,   test_names,   false_pos_controls = NULL,   n_controls = NULL,   false_neg_diseased = NULL,   n_diseased = NULL,   ...,   sens = uniform_prior(),   spec = uniform_prior(),   panel_sens = uniform_prior(),   panel_spec = uniform_prior(),   panel_name = \"Panel\",   confint = 0.95,   fmt = \"%1.2f%% [%1.2f%% — %1.2f%%]\",   chains = 4,   warmup = 1000,   iter = 2000 )"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/bayesian_panel_simpler_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bayesian simpler model true prevalence for panel — bayesian_panel_simpler_model","text":"panel_pos_obs number positive observations given panel tests panel_n_obs number observations component test pos_obs number positive observations given test n_obs number observations given test test_names vector component test names desired order false_pos_controls number positives appeared specificity disease-free control group. definition false positives. (1-specificity)*n_controls n_controls number controls specificity disease-free control group. false_neg_diseased number negatives appeared sensitivity confirmed disease group. definition false negatives. (1-sensitivity)*n_diseased n_diseased number confirmed disease cases sensitivity control group. ... used sens prior sensitivity test beta_dist. spec prior specificity test beta_dist. panel_sens prior sensitivity panel beta_dist (optional) panel_spec prior specificity panel beta_dist (optional) panel_name name panel combined result confint confidence interval limits fmt sprintf formatting string accepting 3 numbers chains positive integer specifying number Markov chains.      default 4. warmup positive integer specifying number warmup (aka burnin)     iterations per chain. step-size adaptation (default),      also controls number iterations adaptation run (    hence warmup samples used inference). number      warmup iterations smaller iter default     iter/2. iter positive integer specifying number iterations      chain (including warmup). default 2000.","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/bayesian_panel_simpler_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bayesian simpler model true prevalence for panel — bayesian_panel_simpler_model","text":"list dataframes containing prevalence, sensitivity, specificity estimates, stanfit object raw fit data","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/beta_dist.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a beta distribution out of probabilities, or positive and negative counts — beta_dist","title":"Generate a beta distribution out of probabilities, or positive and negative counts — beta_dist","text":"Generate beta distribution probabilities, positive negative counts","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/beta_dist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a beta distribution out of probabilities, or positive and negative counts — beta_dist","text":"","code":"beta_dist(..., p = NULL, q = NULL, n = NULL, shape1 = NULL, shape2 = NULL)"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/beta_dist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a beta distribution out of probabilities, or positive and negative counts — beta_dist","text":"... used p first shape / probability count success q (optional) second shape / probability count failure n (optional) number trials. shape1 first shape parameter (use force interpretation shape) shape2 second shape parameter (use force interpretation shape)","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/beta_dist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a beta distribution out of probabilities, or positive and negative counts — beta_dist","text":"either single beta_dist object list beta_dists","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/beta_dist.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate a beta distribution out of probabilities, or positive and negative counts — beta_dist","text":"","code":"beta_dist(shape1 = c(1,2,3),shape2 = c(3,2,1)) #> [[1]] #> 0.206 [0.008–0.708] (N=4.00)  #>  #> [[2]] #> 0.500 [0.094–0.906] (N=4.00)  #>  #> [[3]] #> 0.794 [0.292–0.992] (N=4.00)  #>  #> attr(,\"class\") #> [1] \"beta_dist_list\" \"list\""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/beta_fit.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit a beta distribution to data using method of moments — beta_fit","title":"Fit a beta distribution to data using method of moments — beta_fit","text":"Fit beta distribution data using method moments","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/beta_fit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit a beta distribution to data using method of moments — beta_fit","text":"","code":"beta_fit(samples, na.rm = FALSE)"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/beta_fit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit a beta distribution to data using method of moments — beta_fit","text":"samples set probabilities na.rm ignore NA values","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/beta_fit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit a beta distribution to data using method of moments — beta_fit","text":"beta_dist S3 object fitted data.","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/beta_fit.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fit a beta distribution to data using method of moments — beta_fit","text":"","code":"beta_fit(stats::rbeta(10000,40,60)) #> 0.399 [0.307–0.497] (N=101.64)  beta_fit(stats::rbeta(10000,1,99)) #> 0.007 [0.000–0.036] (N=101.36)"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/beta_params.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate concave beta distribution parameters from mean and confidence intervals — beta_params","title":"Generate concave beta distribution parameters from mean and confidence intervals — beta_params","text":"Generate concave beta distribution parameters mean confidence intervals","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/beta_params.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate concave beta distribution parameters from mean and confidence intervals — beta_params","text":"","code":"beta_params(median, lower, upper, confint = 0.95, widen = 1, limit = 1, ...)"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/beta_params.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate concave beta distribution parameters from mean and confidence intervals — beta_params","text":"median median probability given lower lower ci probability given upper upper ci probability given confint ci limits widen widen spread final beta factor limit lowest possible value shape parameters resulting beta_dist (1 enforces distribution convex) ... used","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/beta_params.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate concave beta distribution parameters from mean and confidence intervals — beta_params","text":"list shape1, shape2 values, d, p, q r functions","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/beta_params.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate concave beta distribution parameters from mean and confidence intervals — beta_params","text":"","code":"beta = beta_params(0.25, 0.1, 0.3)"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/format.beta_dist.html","id":null,"dir":"Reference","previous_headings":"","what":"Format a beta distribution — format.beta_dist","title":"Format a beta distribution — format.beta_dist","text":"Format beta distribution","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/format.beta_dist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Format a beta distribution — format.beta_dist","text":"","code":"# S3 method for beta_dist format(   x,   glue = \"{sprintf('%1.3f [%1.3f–%1.3f] (N=%1.2f)',median,lower,upper,conc)}\",   ... )"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/format.beta_dist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Format a beta distribution — format.beta_dist","text":"x beta distribution glue glue spec taking shape1, shape2, conc, mean, median, upper, lower ... used","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/format.beta_dist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Format a beta distribution — format.beta_dist","text":"nothing","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/format.beta_dist.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Format a beta distribution — format.beta_dist","text":"","code":"format(beta_dist(shape1=3,shape2=6), \"{format(mean*100, digits=3)}%\") #> 33.3%"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/format.beta_dist_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Format a beta distribution list — format.beta_dist_list","title":"Format a beta distribution list — format.beta_dist_list","text":"Format beta distribution list","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/format.beta_dist_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Format a beta distribution list — format.beta_dist_list","text":"","code":"# S3 method for beta_dist_list format(x, ...)"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/format.beta_dist_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Format a beta distribution list — format.beta_dist_list","text":"x beta distribution list ... used","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/format.beta_dist_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Format a beta distribution list — format.beta_dist_list","text":"nothing","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/fp_p_value.html","id":null,"dir":"Reference","previous_headings":"","what":"Significance of an uncertain test result — fp_p_value","title":"Significance of an uncertain test result — fp_p_value","text":"Calculates p-value count positive test results based false positive (specificity) controls. null hypothesis prevalence disease zero.","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/fp_p_value.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Significance of an uncertain test result — fp_p_value","text":"","code":"fp_p_value(   pos_obs,   n_obs,   false_pos_controls,   n_controls,   format = \"%1.3g\",   lim = 1e-04,   bonferroni = NULL,   ... )"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/fp_p_value.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Significance of an uncertain test result — fp_p_value","text":"pos_obs number positive observations given test n_obs number observations given test false_pos_controls number positives appeared specificity disease-free control group. definition false positives. (1-specificity)*n_controls n_controls number controls specificity disease-free control group. format sprintf fmt string p-value lim lower value display bonferroni number simultaneous hypotheses tested ... used","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/fp_p_value.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Significance of an uncertain test result — fp_p_value","text":"vector p-values count","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/fp_p_value.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Significance of an uncertain test result — fp_p_value","text":"p_value tell whether count can trusted prevalence disease significantly zero observation.","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/fp_p_value.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Significance of an uncertain test result — fp_p_value","text":"","code":"# calculate p-values for counts derived from 300 samples # 10 observations is within noise of test # 20 observations is unlikely on 1200 observations fp_p_value(c(10,2,4,3,10,20), 1200, c(0,0,2,0,2,0)+2, 800) #> [1] \"0.0571\"     \"0.682\"      \"0.733\"      \"0.544\"      \"0.216\"      #> [6] \"0.000956 †\"  # if the same observations are made against a smaller group then we get  # a positive result for 10 fp_p_value( c(10,2,4,3,10,20), 1000, c(2,2,4,2,4,2), 800) #> [1] \"0.0289\"     \"0.603\"      \"0.634\"      \"0.452\"      \"0.128\"      #> [6] \"0.000224 †\"  tibble::tibble(   x = c(1,2,5,10,20,40,20,20,20,20,20),   n = 1000,   fp_controls = c(0,0,0,0,0,0,0,1,2,3,4)+2,   n_controls = 800 ) %>% dplyr::mutate(   p_value = fp_p_value(x, n, fp_controls, n_controls) ) %>% dplyr::glimpse() #> Rows: 11 #> Columns: 5 #> $ x           <dbl> 1, 2, 5, 10, 20, 40, 20, 20, 20, 20, 20 #> $ n           <dbl> 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000… #> $ fp_controls <dbl> 2, 2, 2, 2, 2, 2, 2, 3, 4, 5, 6 #> $ n_controls  <dbl> 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800 #> $ p_value     <chr> \"0.766\", \"0.603\", \"0.229\", \"0.0289\", \"0.000224 †\", \"<0.000…"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/fp_signif_level.html","id":null,"dir":"Reference","previous_headings":"","what":"Identify the minimum number of positive test result observations needed\nto be confident the disease has a non-zero prevalence. — fp_signif_level","title":"Identify the minimum number of positive test result observations needed\nto be confident the disease has a non-zero prevalence. — fp_signif_level","text":"Identify minimum number positive test result observations needed confident disease non-zero prevalence.","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/fp_signif_level.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identify the minimum number of positive test result observations needed\nto be confident the disease has a non-zero prevalence. — fp_signif_level","text":"","code":"fp_signif_level(   n_obs,   false_pos_controls,   n_controls,   bonferroni = NULL,   ...,   spec = NULL )"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/fp_signif_level.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identify the minimum number of positive test result observations needed\nto be confident the disease has a non-zero prevalence. — fp_signif_level","text":"n_obs number tests performed. false_pos_controls number positives appeared specificity disease-free control group. definition false positives. (1-specificity)*n_controls n_controls number controls specificity disease-free control group. bonferroni number simultaneous tests considered. ... used","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/fp_signif_level.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identify the minimum number of positive test result observations needed\nto be confident the disease has a non-zero prevalence. — fp_signif_level","text":"vector test positive counts lowest significant value regarded due chance.","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/fp_signif_level.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Identify the minimum number of positive test result observations needed\nto be confident the disease has a non-zero prevalence. — fp_signif_level","text":"","code":"# lowest significant count of positives in 1000 tests  fp_signif_level(1000, false_pos_controls = 0:5, n_controls=800) #> [1]  0  5  7  9 11 13 fp_signif_level(c(1000,800,600,400), false_pos_controls = 1:4, n_controls=800) #> [1] 5 6 6 5"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/get_beta_shape.beta_dist.html","id":null,"dir":"Reference","previous_headings":"","what":"Get a parameter of the beta_dist — get_beta_shape.beta_dist","title":"Get a parameter of the beta_dist — get_beta_shape.beta_dist","text":"Get parameter beta_dist","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/get_beta_shape.beta_dist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get a parameter of the beta_dist — get_beta_shape.beta_dist","text":"","code":"# S3 method for beta_dist get_beta_shape(x, type = c(\"shape1\", \"shape2\", \"conc\"))"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/get_beta_shape.beta_dist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get a parameter of the beta_dist — get_beta_shape.beta_dist","text":"x beta_dist beta_dist_list acting prior type parameter extract one shape1 shape2 conc","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/get_beta_shape.beta_dist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get a parameter of the beta_dist — get_beta_shape.beta_dist","text":"vector doubles","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/get_beta_shape.beta_dist.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get a parameter of the beta_dist — get_beta_shape.beta_dist","text":"","code":"get_beta_shape(beta_dist(shape1=1,shape2=1)) #> [1] 1 get_beta_shape(beta_dist(shape1=2:5,shape2=1:4)) #> [1] 2 3 4 5"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/get_beta_shape.beta_dist_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Get a parameter of the beta_dist — get_beta_shape.beta_dist_list","title":"Get a parameter of the beta_dist — get_beta_shape.beta_dist_list","text":"Get parameter beta_dist","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/get_beta_shape.beta_dist_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get a parameter of the beta_dist — get_beta_shape.beta_dist_list","text":"","code":"# S3 method for beta_dist_list get_beta_shape(x, type = c(\"shape1\", \"shape2\", \"conc\"))"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/get_beta_shape.beta_dist_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get a parameter of the beta_dist — get_beta_shape.beta_dist_list","text":"x beta_dist beta_dist_list acting prior type parameter extract one shape1 shape2 conc","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/get_beta_shape.beta_dist_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get a parameter of the beta_dist — get_beta_shape.beta_dist_list","text":"vector doubles","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/get_beta_shape.beta_dist_list.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get a parameter of the beta_dist — get_beta_shape.beta_dist_list","text":"","code":"get_beta_shape(beta_dist(shape1=1,shape2=1)) #> [1] 1 get_beta_shape(beta_dist(shape1=2:5,shape2=1:4)) #> [1] 2 3 4 5"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/get_beta_shape.html","id":null,"dir":"Reference","previous_headings":"","what":"Get a parameter of the beta_dist — get_beta_shape","title":"Get a parameter of the beta_dist — get_beta_shape","text":"Get parameter beta_dist","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/get_beta_shape.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get a parameter of the beta_dist — get_beta_shape","text":"","code":"get_beta_shape(x, type = c(\"shape1\", \"shape2\", \"conc\"))"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/get_beta_shape.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get a parameter of the beta_dist — get_beta_shape","text":"x beta_dist beta_dist_list acting prior type parameter extract one shape1 shape2 conc","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/get_beta_shape.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get a parameter of the beta_dist — get_beta_shape","text":"vector doubles","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/get_beta_shape.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get a parameter of the beta_dist — get_beta_shape","text":"","code":"get_beta_shape(beta_dist(shape1=1,shape2=1)) #> [1] 1 get_beta_shape(beta_dist(shape1=2:5,shape2=1:4)) #> [1] 2 3 4 5"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/length.beta_dist.html","id":null,"dir":"Reference","previous_headings":"","what":"Detect the length of a beta distribution — length.beta_dist","title":"Detect the length of a beta distribution — length.beta_dist","text":"Detect length beta distribution","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/length.beta_dist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Detect the length of a beta distribution — length.beta_dist","text":"","code":"# S3 method for beta_dist length(x, ...)"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/length.beta_dist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Detect the length of a beta distribution — length.beta_dist","text":"x beta distribution ... used","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/length.beta_dist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Detect the length of a beta distribution — length.beta_dist","text":"always 1","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/odds_ratio_ve.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate a vaccine effectiveness estimate based on an odds ratio — odds_ratio_ve","title":"Calculate a vaccine effectiveness estimate based on an odds ratio — odds_ratio_ve","text":"assumes ~ RR true controls >> cases method can used test negative designs disease positive relates vaccine treatable disease disease negative relates non vaccine treatable disease assumes ~ RR true controls >> cases method can used test negative designs disease positive relates vaccine treatable disease disease negative relates non vaccine treatable disease","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/odds_ratio_ve.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate a vaccine effectiveness estimate based on an odds ratio — odds_ratio_ve","text":"","code":"odds_ratio_ve(   vaccinatedCase,   unvaccinatedCase,   vaccinatedControl,   unvaccinatedControl,   confint = c(0.025, 0.975) )  odds_ratio_ve(   vaccinatedCase,   unvaccinatedCase,   vaccinatedControl,   unvaccinatedControl,   confint = c(0.025, 0.975) )"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/odds_ratio_ve.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate a vaccine effectiveness estimate based on an odds ratio — odds_ratio_ve","text":"vaccinatedCase count disease positive vaccine positive unvaccinatedCase count disease positive vaccine negative vaccinatedControl count disease negative vaccine positive unvaccinatedControl count disease negative vaccine positive confint confidence intervals","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/odds_ratio_ve.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate a vaccine effectiveness estimate based on an odds ratio — odds_ratio_ve","text":"dataframe dataframe","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/odds_ratio_ve.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate a vaccine effectiveness estimate based on an odds ratio — odds_ratio_ve","text":"","code":"tibble::tibble(   N_vacc = 42240,   N_unvacc = 42256,   N_vacc_pn_pos = 49,   N_unvacc_pn_pos = 90 ) %>% dplyr::mutate(   odds_ratio_ve(N_vacc_pn_pos, N_unvacc_pn_pos, N_vacc-N_vacc_pn_pos, N_unvacc-N_unvacc_pn_pos) ) #> # A tibble: 1 × 10 #>   N_vacc N_unvacc N_vacc_pn_pos N_unvacc_pn_pos    OR OR.q.0.025 OR.q.0.975 #>    <dbl>    <dbl>         <dbl>           <dbl> <dbl>      <dbl>      <dbl> #> 1  42240    42256            49              90 0.544      0.384      0.771 #> # ℹ 3 more variables: VE.OR <dbl>, VE.OR.q.0.025 <dbl>, VE.OR.q.0.975 <dbl>   tibble::tibble(   N_vacc = 42240,   N_unvacc = 42256,   N_vacc_pn_pos = 49,   N_unvacc_pn_pos = 90 ) %>% dplyr::mutate(   odds_ratio_ve(N_vacc_pn_pos, N_unvacc_pn_pos, N_vacc-N_vacc_pn_pos, N_unvacc-N_unvacc_pn_pos) ) #> # A tibble: 1 × 10 #>   N_vacc N_unvacc N_vacc_pn_pos N_unvacc_pn_pos    OR OR.q.0.025 OR.q.0.975 #>    <dbl>    <dbl>         <dbl>           <dbl> <dbl>      <dbl>      <dbl> #> 1  42240    42256            49              90 0.544      0.384      0.771 #> # ℹ 3 more variables: VE.OR <dbl>, VE.OR.q.0.025 <dbl>, VE.OR.q.0.975 <dbl>"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/optimal_performance.html","id":null,"dir":"Reference","previous_headings":"","what":"Test optimal performance — optimal_performance","title":"Test optimal performance — optimal_performance","text":"given combination prevalence, sensitivity specificity gives critical threshold true prevalence equals apparent prevalence","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/optimal_performance.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Test optimal performance — optimal_performance","text":"","code":"optimal_performance(p = NULL, sens = NULL, spec = NULL)"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/optimal_performance.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Test optimal performance — optimal_performance","text":"p prevalence apparent prevalence sens sensitivity test spec specificity test","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/optimal_performance.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Test optimal performance — optimal_performance","text":"combination sensitivity specificity apparent prevalence equals true prevalence","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/optimal_performance.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Test optimal performance — optimal_performance","text":"","code":"optimal_performance(p=0.1, sens=0.75) #> $p #> [1] 0.1 #>  #> $sens #> [1] 0.75 #>  #> $spec #> [1] 0.9722256 #>  optimal_performance(p=0.005, spec=0.9975) #> $p #> [1] 0.005 #>  #> $sens #> [1] 0.5024969 #>  #> $spec #> [1] 0.9975 #>"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/panel_prevalence.html","id":null,"dir":"Reference","previous_headings":"","what":"Expected test panel prevalence assuming independence — panel_prevalence","title":"Expected test panel prevalence assuming independence — panel_prevalence","text":"Expected test panel prevalence assuming independence","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/panel_prevalence.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Expected test panel prevalence assuming independence — panel_prevalence","text":"","code":"panel_prevalence(p, na.rm = FALSE)"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/panel_prevalence.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Expected test panel prevalence assuming independence — panel_prevalence","text":"p vector prevalences component tests na.rm remove NA values?","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/panel_prevalence.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Expected test panel prevalence assuming independence — panel_prevalence","text":"single value effective specificity combination tests","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/panel_prevalence.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Expected test panel prevalence assuming independence — panel_prevalence","text":"","code":"panel_prevalence(p = rep(0.01,24)) #> [1] 0.2143219"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/panel_sens.html","id":null,"dir":"Reference","previous_headings":"","what":"Test panel combination sensitivity — panel_sens","title":"Test panel combination sensitivity — panel_sens","text":"Calculate sensitivity combination tests, tests testing different conditions positive results combined panel using logical . false negatives component panel can cancelled true positives, false positives components test depending prevalence underlying conditions, combined false negative rate lower cases arecombine false positive rate panel higher individual components (hence true negative rate .k.specificity lower).","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/panel_sens.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Test panel combination sensitivity — panel_sens","text":"","code":"panel_sens(p, sens, spec, na.rm = FALSE)"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/panel_sens.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Test panel combination sensitivity — panel_sens","text":"p true prevalence (one p ap must given) sens vector sensitivities component tests spec vector specificity component tests na.rm remove NA values?","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/panel_sens.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Test panel combination sensitivity — panel_sens","text":"effective specificity combination tests","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/panel_sens.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Test panel combination sensitivity — panel_sens","text":"","code":"#TODO"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/panel_sens_estimator.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate test panel combination sensitivity — panel_sens_estimator","title":"Estimate test panel combination sensitivity — panel_sens_estimator","text":"Estimate sensitivity combination tests, tests testing different conditions positive results combined panel using logical . false negatives component panel can cancelled true positives, false positives components test depending prevalence underlying conditions, combined false negative rate lower cases arecombine false positive rate panel higher individual components (hence true negative rate .k.specificity lower).","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/panel_sens_estimator.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate test panel combination sensitivity — panel_sens_estimator","text":"","code":"panel_sens_estimator(ap, sens, spec, na.rm = FALSE)"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/panel_sens_estimator.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate test panel combination sensitivity — panel_sens_estimator","text":"ap apparent prevalence test positivity (one p ap must given) sens vector sensitivities component tests spec vector specificity component tests na.rm remove NA values?","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/panel_sens_estimator.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate test panel combination sensitivity — panel_sens_estimator","text":"effective specificity combination tests","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/panel_sens_estimator.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate test panel combination sensitivity — panel_sens_estimator","text":"","code":"#TODO"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/panel_spec.html","id":null,"dir":"Reference","previous_headings":"","what":"Test panel combination specificity — panel_spec","title":"Test panel combination specificity — panel_spec","text":"Calculate specificity combination tests, tests testing different conditions positive results combined panel using logical . false positives component panel combine false positive rate panel higher individual components (hence true negative rate .k.specificity lower).","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/panel_spec.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Test panel combination specificity — panel_spec","text":"","code":"panel_spec(spec, na.rm = FALSE)"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/panel_spec.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Test panel combination specificity — panel_spec","text":"spec vector specificity component tests na.rm remove NA values?","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/panel_spec.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Test panel combination specificity — panel_spec","text":"single value effective specificity combination tests","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/panel_spec.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Test panel combination specificity — panel_spec","text":"","code":"panel_spec(spec = rep(0.9975,24)) #> [1] 0.9416938"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/pipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pipe operator — %>%","text":"lhs value magrittr placeholder. rhs function call using magrittr semantics.","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/pipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pipe operator — %>%","text":"result calling rhs(lhs).","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/prevalence_lang_reiczigel.html","id":null,"dir":"Reference","previous_headings":"","what":"True prevalence from apparent prevalence with uncertainty — prevalence_lang_reiczigel","title":"True prevalence from apparent prevalence with uncertainty — prevalence_lang_reiczigel","text":"Uses lang-reiczigel estimators incorporate uncertainty sensitivity specificity estimate true prevalence given value apparent prevalence.","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/prevalence_lang_reiczigel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"True prevalence from apparent prevalence with uncertainty — prevalence_lang_reiczigel","text":"","code":"prevalence_lang_reiczigel(   pos_obs,   n_obs,   false_pos_controls,   n_controls,   false_neg_diseased,   n_diseased,   ...,   spec = spec_prior(),   sens = sens_prior(),   confint = 0.95,   fmt = \"%1.2f%% [%1.2f%% — %1.2f%%]\" )"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/prevalence_lang_reiczigel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"True prevalence from apparent prevalence with uncertainty — prevalence_lang_reiczigel","text":"pos_obs number positive observations given test n_obs number observations given test false_pos_controls number positives appeared specificity disease-free control group. definition false positives. (1-specificity)*n_controls n_controls number controls specificity disease-free control group. false_neg_diseased number negatives appeared sensitivity confirmed disease group. definition false negatives. (1-sensitivity)*n_diseased n_diseased number confirmed disease cases sensitivity control group. ... used spec prior specificity test beta_dist. sens prior sensitivity test beta_dist. confint confidence interval limits fmt sprintf formatting string accepting 3 numbers","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/prevalence_lang_reiczigel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"True prevalence from apparent prevalence with uncertainty — prevalence_lang_reiczigel","text":"expected value apparent prevalence","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/prevalence_panel_lang_reiczigel.html","id":null,"dir":"Reference","previous_headings":"","what":"Lang-Reiczigel true prevalence for panel — prevalence_panel_lang_reiczigel","title":"Lang-Reiczigel true prevalence for panel — prevalence_panel_lang_reiczigel","text":"Uses resampling incorporate uncertainty sensitivity specificity estimate true prevalence given value apparent prevalence.","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/prevalence_panel_lang_reiczigel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Lang-Reiczigel true prevalence for panel — prevalence_panel_lang_reiczigel","text":"","code":"prevalence_panel_lang_reiczigel(   panel_pos_obs,   panel_n_obs,   pos_obs,   n_obs,   false_pos_controls = NULL,   n_controls = NULL,   false_neg_diseased = NULL,   n_diseased = NULL,   ...,   spec = spec_prior(),   sens = sens_prior(),   samples = 1000 )"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/prevalence_panel_lang_reiczigel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Lang-Reiczigel true prevalence for panel — prevalence_panel_lang_reiczigel","text":"panel_pos_obs number positive observations given panel tests panel_n_obs vector number observations component test pos_obs number positive observations given test n_obs number observations given test false_pos_controls number positives appeared specificity disease-free control group. definition false positives. (1-specificity)*n_controls n_controls number controls specificity disease-free control group. false_neg_diseased number negatives appeared sensitivity confirmed disease group. definition false negatives. (1-sensitivity)*n_diseased n_diseased number confirmed disease cases sensitivity control group. ... Arguments passed prevalence_lang_reiczigel confint confidence interval limits fmt sprintf formatting string accepting 3 numbers spec prior specificity test beta_dist. sens prior sensitivity test beta_dist. samples number random draws sensitivity specificity (optional - default 1000)","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/prevalence_panel_lang_reiczigel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Lang-Reiczigel true prevalence for panel — prevalence_panel_lang_reiczigel","text":"expected value apparent prevalence","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/prevalence_panel_lang_reiczigel.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Lang-Reiczigel true prevalence for panel — prevalence_panel_lang_reiczigel","text":"vectorised","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/prevalence_panel_lang_reiczigel.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Lang-Reiczigel true prevalence for panel — prevalence_panel_lang_reiczigel","text":"","code":"#TODO"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/print.beta_dist.html","id":null,"dir":"Reference","previous_headings":"","what":"Print a beta distribution — print.beta_dist","title":"Print a beta distribution — print.beta_dist","text":"Print beta distribution","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/print.beta_dist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print a beta distribution — print.beta_dist","text":"","code":"# S3 method for beta_dist print(x, ...)"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/print.beta_dist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print a beta distribution — print.beta_dist","text":"x beta distribution ... used","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/print.beta_dist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print a beta distribution — print.beta_dist","text":"nothing","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/relative_risk_ve.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate a vaccine effectiveness estimate based on a risk ratio — relative_risk_ve","title":"Calculate a vaccine effectiveness estimate based on a risk ratio — relative_risk_ve","text":"RR method used test negative designs disease positive relates vaccine treatable disease disease negative relates non vaccine treatable disease. relevant prospective designs vaccinated unvaccinated group.","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/relative_risk_ve.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate a vaccine effectiveness estimate based on a risk ratio — relative_risk_ve","text":"","code":"relative_risk_ve(   vaccinatedCase,   unvaccinatedCase,   vaccinatedControl,   unvaccinatedControl,   confint = c(0.025, 0.975) )"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/relative_risk_ve.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate a vaccine effectiveness estimate based on a risk ratio — relative_risk_ve","text":"vaccinatedCase count disease positive vaccine positive unvaccinatedCase count disease positive vaccine negative vaccinatedControl count disease negative vaccine positive unvaccinatedControl count disease negative vaccine positive confint confidence intervals","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/relative_risk_ve.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate a vaccine effectiveness estimate based on a risk ratio — relative_risk_ve","text":"dataframe","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/relative_risk_ve.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate a vaccine effectiveness estimate based on a risk ratio — relative_risk_ve","text":"","code":"tibble::tibble(   N_vacc = 42240,   N_unvacc = 42256,   N_vacc_pn_pos = 49,   N_unvacc_pn_pos = 90 ) %>% dplyr::mutate(   relative_risk_ve(N_vacc_pn_pos, N_unvacc_pn_pos, N_vacc-N_vacc_pn_pos, N_unvacc-N_unvacc_pn_pos) ) #> # A tibble: 1 × 10 #>   N_vacc N_unvacc N_vacc_pn_pos N_unvacc_pn_pos    RR RR.q.0.025 RR.q.0.975 #>    <dbl>    <dbl>         <dbl>           <dbl> <dbl>      <dbl>      <dbl> #> 1  42240    42256            49              90 0.545      0.384      0.772 #> # ℹ 3 more variables: VE.RR <dbl>, VE.RR.q.0.025 <dbl>, VE.RR.q.0.975 <dbl>  # dplyr::bind_rows(lapply( #   c(\"katz.log\", \"adj.log\", \"bailey\", \"koopman\", \"noether\",  \"sinh-1\", \"boot\"), #   function(m) {tibble::as_tibble( #     1-DescTools::BinomRatioCI(N_vacc_pn_pos, N_vacc, N_unvacc_pn_pos, N_unvacc, method = m) #   ) %>% dplyr::mutate( #     method = m #   )} # ))"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/rep.beta_dist.html","id":null,"dir":"Reference","previous_headings":"","what":"Repeat a beta_dist — rep.beta_dist","title":"Repeat a beta_dist — rep.beta_dist","text":"Repeat beta_dist","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/rep.beta_dist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Repeat a beta_dist — rep.beta_dist","text":"","code":"# S3 method for beta_dist rep(x, times)"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/rep.beta_dist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Repeat a beta_dist — rep.beta_dist","text":"x beta_dist times n","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/rep.beta_dist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Repeat a beta_dist — rep.beta_dist","text":"beta_dist_list","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/rogan_gladen.html","id":null,"dir":"Reference","previous_headings":"","what":"True prevalence from apparent prevalence — rogan_gladen","title":"True prevalence from apparent prevalence — rogan_gladen","text":"estimator runs problems small AP Rogan-Gladen conversion really using expected apparent prevalence. Getting expected value AP distribution complex expected value given single observation general ratio positives / count. expected apparent prevalence never less specificity observed value often . deal R-G estimator truncates zero.","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/rogan_gladen.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"True prevalence from apparent prevalence — rogan_gladen","text":"","code":"rogan_gladen(ap, sens, spec)"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/rogan_gladen.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"True prevalence from apparent prevalence — rogan_gladen","text":"ap expected apparent prevalence. sens sensitivity test spec specificity test","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/rogan_gladen.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"True prevalence from apparent prevalence — rogan_gladen","text":"estimate 'true prevalence'","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/rogan_gladen.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"True prevalence from apparent prevalence — rogan_gladen","text":"","code":"rogan_gladen(50/200, 0.75, 0.97) #> [1] 0.3055556"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/sens_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"The default prior for specificity — sens_prior","title":"The default prior for specificity — sens_prior","text":"undefined 0.773 0.109–0.999 (N=2.00). can set options(testerror.sens_prior = beta_dist(p=??, n=??))","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/sens_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The default prior for specificity — sens_prior","text":"","code":"sens_prior()"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/sens_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"The default prior for specificity — sens_prior","text":"beta_dist","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/spec_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"The default prior for specificity — spec_prior","title":"The default prior for specificity — spec_prior","text":"undefined 1.000 0.710–1.000 (N=1.00). can set options(testerror.spec_prior = beta_dist(p=??, n=??))","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/spec_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The default prior for specificity — spec_prior","text":"","code":"spec_prior()"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/spec_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"The default prior for specificity — spec_prior","text":"beta_dist","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/true_panel_prevalence.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate an estimate of true prevalence for a single panel and components — true_panel_prevalence","title":"Calculate an estimate of true prevalence for a single panel and components — true_panel_prevalence","text":"Uses apparent prevalence, uncertain estimates test sensitivity test specificity 3 methods described Supplementary 2. function works single panel per dataframe, multiple panels need call function multiple times group_modify.","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/true_panel_prevalence.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate an estimate of true prevalence for a single panel and components — true_panel_prevalence","text":"","code":"true_panel_prevalence(   test_results = testerror:::.input_data,   false_pos_controls = NULL,   n_controls = NULL,   false_neg_diseased = NULL,   n_diseased = NULL,   ...,   sens = NULL,   spec = NULL,   panel_name = \"Panel\",   confint = 0.95,   method = c(\"rogan-gladen\", \"lang-reiczigel\", \"bayes\"),   na.rm = TRUE )"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/true_panel_prevalence.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate an estimate of true prevalence for a single panel and components — true_panel_prevalence","text":"test_results dataframe containing following columns: id (character) - patient identifier result (logical) - test result test (factor) - test type Ungrouped false_pos_controls number positives appeared specificity disease-free control group. definition false positives. (1-specificity)*n_controls n_controls number controls specificity disease-free control group. false_neg_diseased number negatives appeared sensitivity confirmed disease group. definition false negatives. (1-sensitivity)*n_diseased n_diseased number confirmed disease cases sensitivity control group. ... Arguments passed bayesian_panel_complex_model, bayesian_panel_simpler_model panel_sens prior sensitivity panel beta_dist (optional) panel_spec prior specificity panel beta_dist (optional) fmt sprintf formatting string accepting 3 numbers chains positive integer specifying number Markov chains.      default 4. iter positive integer specifying number iterations      chain (including warmup). default 2000. warmup positive integer specifying number warmup (aka burnin)     iterations per chain. step-size adaptation (default),      also controls number iterations adaptation run (    hence warmup samples used inference). number      warmup iterations smaller iter default     iter/2. sens prior sensitivity test beta_dist. spec prior specificity test beta_dist. panel_name name panel combined result confint confidence interval limits method one : \"lang-reiczigel\": Frequentist confidence limits \"bayes\": Bayesian analysis \"rogan-gladen\": Rogan gladen uncertainty na.rm exclude patients missing results","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/true_panel_prevalence.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate an estimate of true prevalence for a single panel and components — true_panel_prevalence","text":"dataframe containing following columns: prevalence.label (character) - fomatted label true prevalence estimate CI prevalence.lower (numeric) - lower estimate prevalence.median (numeric) - median estimate prevalence.method (character) - method estimation prevalence.upper (numeric) - upper estimate test (character) - name test panel Ungrouped","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/true_panel_prevalence.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate an estimate of true prevalence for a single panel and components — true_panel_prevalence","text":"","code":"tmp = testerror:::panel_example() #> Error in mutate(., n_components = n()): could not find function \"mutate\" true_panel_prevalence(   test_results = tmp$samples %>% dplyr::select(id,test,result = observed),   false_pos_controls = tmp$performance$false_pos_controls,   n_controls = tmp$performance$n_controls,   false_neg_diseased = tmp$performance$false_neg_diseased,   n_diseased = tmp$performance$n_diseased,   method = \"rogan-gladen\" ) #> Error in eval(expr, envir, enclos): object 'tmp' not found"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/true_prevalence.html","id":null,"dir":"Reference","previous_headings":"","what":"Vectorised true prevalence estimates — true_prevalence","title":"Vectorised true prevalence estimates — true_prevalence","text":"Calculate estimate true prevalence apparent prevalence, uncertain estimates test sensitivity test specificity, using one 3 methods.","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/true_prevalence.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Vectorised true prevalence estimates — true_prevalence","text":"","code":"true_prevalence(   pos_obs,   n_obs,   false_pos_controls = NULL,   n_controls = NULL,   false_neg_diseased = NULL,   n_diseased = NULL,   confint = 0.95,   method = c(\"lang-reiczigel\", \"rogan-gladen\", \"bayes\"),   ...,   spec = NULL,   sens = NULL )"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/true_prevalence.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Vectorised true prevalence estimates — true_prevalence","text":"pos_obs number positive observations given test n_obs number observations given test false_pos_controls number positives appeared specificity disease-free control group. definition false positives. (1-specificity)*n_controls n_controls number controls specificity disease-free control group. false_neg_diseased number negatives appeared sensitivity confirmed disease group. definition false negatives. (1-sensitivity)*n_diseased n_diseased number confirmed disease cases sensitivity control group. confint confidence interval limits method one : \"lang-reiczigel\": Frequentist confidence limits: see prevalence_lang_reiczigel() \"rogan-gladen\": Rogan gladen incorporating uncertainty resampling: see uncertain_rogan_gladen() \"bayes\": Bayesian analysis: see bayesian_component_simpler_model() ... Arguments passed uncertain_rogan_gladen samples number fo random draws sensitivity specificity fmt sprintf formatting string accepting 3 numbers seed set seed reproducibility spec prior specificity test beta_dist. sens prior sensitivity test beta_dist.","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/true_prevalence.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Vectorised true prevalence estimates — true_prevalence","text":"dataframe containing following columns: prevalence.label (character) - fomatted label true prevalence estimate CI prevalence.lower (numeric) - lower estimate prevalence.median (numeric) - median estimate prevalence.method (character) - method estimation prevalence.upper (numeric) - upper estimate test (character) - name test panel Ungrouped","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/true_prevalence.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Vectorised true prevalence estimates — true_prevalence","text":"","code":"true_prevalence(c(1:50), 200, 2, 800, 25, 75) #> # A tibble: 50 × 15 #>    prevalence.lower prevalence.median prevalence.upper prevalence.method #>               <dbl>             <dbl>            <dbl> <chr>             #>  1          0                 0.00373           0.0420 lang-reiczigel    #>  2          0                 0.0112            0.0534 lang-reiczigel    #>  3          0                 0.0188            0.0644 lang-reiczigel    #>  4          0.00313           0.0263            0.0751 lang-reiczigel    #>  5          0.00787           0.0338            0.0856 lang-reiczigel    #>  6          0.0128            0.0413            0.0959 lang-reiczigel    #>  7          0.0179            0.0488            0.106  lang-reiczigel    #>  8          0.0231            0.0564            0.116  lang-reiczigel    #>  9          0.0284            0.0639            0.126  lang-reiczigel    #> 10          0.0338            0.0714            0.136  lang-reiczigel    #> # ℹ 40 more rows #> # ℹ 11 more variables: prevalence.label <chr>, spec.median <dbl>, #> #   spec.lower <dbl>, spec.upper <dbl>, spec.label <chr>, sens.median <dbl>, #> #   sens.lower <dbl>, sens.upper <dbl>, sens.label <chr>, pos_obs <int>, #> #   n_obs <dbl> true_prevalence(c(1:10)*2, 200, 25, 800, 1, 6, method=\"rogan-gladen\") #> # A tibble: 10 × 15 #>    prevalence.median prevalence.lower prevalence.upper prevalence.label       #>                <dbl>            <dbl>            <dbl> <chr>                  #>  1            0               0                 0      0.00% [0.00% — 0.00%]  #>  2            0               0                 0      0.00% [0.00% — 0.00%]  #>  3            0               0                 0.0121 0.00% [0.00% — 1.21%]  #>  4            0.0119          0                 0.0308 1.19% [0.00% — 3.08%]  #>  5            0.0250          0.00864           0.0512 2.50% [0.86% — 5.12%]  #>  6            0.0374          0.0195            0.0676 3.74% [1.95% — 6.76%]  #>  7            0.0499          0.0311            0.0866 4.99% [3.11% — 8.66%]  #>  8            0.0620          0.0423            0.112  6.20% [4.23% — 11.24%] #>  9            0.0745          0.0547            0.124  7.45% [5.47% — 12.41%] #> 10            0.0876          0.0673            0.159  8.76% [6.73% — 15.91%] #> # ℹ 11 more variables: spec.median <dbl>, spec.lower <dbl>, spec.upper <dbl>, #> #   spec.label <chr>, sens.median <dbl>, sens.lower <dbl>, sens.upper <dbl>, #> #   sens.label <chr>, prevalence.method <chr>, pos_obs <dbl>, n_obs <dbl> true_prevalence(c(1:10)*2, 200, 5, 800, 1, 6, method=\"bayes\") #>  #> SAMPLING FOR MODEL 'component-simpler' NOW (CHAIN 1). #> Chain 1:  #> Chain 1: Gradient evaluation took 2e-05 seconds #> Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.2 seconds. #> Chain 1: Adjust your expectations accordingly! #> Chain 1:  #> Chain 1:  #> Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup) #> Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup) #> Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup) #> Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup) #> Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup) #> Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup) #> Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling) #> Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling) #> Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling) #> Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling) #> Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling) #> Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling) #> Chain 1:  #> Chain 1:  Elapsed Time: 0.158783 seconds (Warm-up) #> Chain 1:                0.152411 seconds (Sampling) #> Chain 1:                0.311194 seconds (Total) #> Chain 1:  #>  #> SAMPLING FOR MODEL 'component-simpler' NOW (CHAIN 2). #> Chain 2:  #> Chain 2: Gradient evaluation took 1.5e-05 seconds #> Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.15 seconds. #> Chain 2: Adjust your expectations accordingly! #> Chain 2:  #> Chain 2:  #> Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup) #> Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup) #> Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup) #> Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup) #> Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup) #> Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup) #> Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling) #> Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling) #> Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling) #> Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling) #> Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling) #> Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling) #> Chain 2:  #> Chain 2:  Elapsed Time: 0.153795 seconds (Warm-up) #> Chain 2:                0.14783 seconds (Sampling) #> Chain 2:                0.301625 seconds (Total) #> Chain 2:  #>  #> SAMPLING FOR MODEL 'component-simpler' NOW (CHAIN 3). #> Chain 3:  #> Chain 3: Gradient evaluation took 1.5e-05 seconds #> Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.15 seconds. #> Chain 3: Adjust your expectations accordingly! #> Chain 3:  #> Chain 3:  #> Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup) #> Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup) #> Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup) #> Chain 3: Iteration:  600 / 2000 [ 30%]  (Warmup) #> Chain 3: Iteration:  800 / 2000 [ 40%]  (Warmup) #> Chain 3: Iteration: 1000 / 2000 [ 50%]  (Warmup) #> Chain 3: Iteration: 1001 / 2000 [ 50%]  (Sampling) #> Chain 3: Iteration: 1200 / 2000 [ 60%]  (Sampling) #> Chain 3: Iteration: 1400 / 2000 [ 70%]  (Sampling) #> Chain 3: Iteration: 1600 / 2000 [ 80%]  (Sampling) #> Chain 3: Iteration: 1800 / 2000 [ 90%]  (Sampling) #> Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling) #> Chain 3:  #> Chain 3:  Elapsed Time: 0.160532 seconds (Warm-up) #> Chain 3:                0.150666 seconds (Sampling) #> Chain 3:                0.311198 seconds (Total) #> Chain 3:  #>  #> SAMPLING FOR MODEL 'component-simpler' NOW (CHAIN 4). #> Chain 4:  #> Chain 4: Gradient evaluation took 1.5e-05 seconds #> Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.15 seconds. #> Chain 4: Adjust your expectations accordingly! #> Chain 4:  #> Chain 4:  #> Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup) #> Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup) #> Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup) #> Chain 4: Iteration:  600 / 2000 [ 30%]  (Warmup) #> Chain 4: Iteration:  800 / 2000 [ 40%]  (Warmup) #> Chain 4: Iteration: 1000 / 2000 [ 50%]  (Warmup) #> Chain 4: Iteration: 1001 / 2000 [ 50%]  (Sampling) #> Chain 4: Iteration: 1200 / 2000 [ 60%]  (Sampling) #> Chain 4: Iteration: 1400 / 2000 [ 70%]  (Sampling) #> Chain 4: Iteration: 1600 / 2000 [ 80%]  (Sampling) #> Chain 4: Iteration: 1800 / 2000 [ 90%]  (Sampling) #> Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling) #> Chain 4:  #> Chain 4:  Elapsed Time: 0.146729 seconds (Warm-up) #> Chain 4:                0.147935 seconds (Sampling) #> Chain 4:                0.294664 seconds (Total) #> Chain 4:  #> # A tibble: 10 × 15 #>    prevalence.median prevalence.lower prevalence.upper prevalence.label        #>                <dbl>            <dbl>            <dbl> <chr>                   #>  1            0.0120         0.000653           0.0515 1.20% [0.07% — 5.15%]   #>  2            0.0236         0.00239            0.0720 2.36% [0.24% — 7.20%]   #>  3            0.0368         0.00787            0.105  3.68% [0.79% — 10.50%]  #>  4            0.0508         0.0170             0.127  5.08% [1.70% — 12.67%]  #>  5            0.0642         0.0261             0.156  6.42% [2.61% — 15.58%]  #>  6            0.0794         0.0352             0.188  7.94% [3.52% — 18.79%]  #>  7            0.0919         0.0447             0.210  9.19% [4.47% — 21.02%]  #>  8            0.107          0.0549             0.244  10.70% [5.49% — 24.36%] #>  9            0.120          0.0660             0.266  12.01% [6.60% — 26.63%] #> 10            0.133          0.0750             0.285  13.30% [7.50% — 28.50%] #> # ℹ 11 more variables: prevalence.method <chr>, sens.median <dbl>, #> #   sens.lower <dbl>, sens.upper <dbl>, sens.label <chr>, spec.median <dbl>, #> #   spec.lower <dbl>, spec.upper <dbl>, spec.label <chr>, pos_obs <dbl>, #> #   n_obs <dbl>"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/uncertain_panel_rogan_gladen.html","id":null,"dir":"Reference","previous_headings":"","what":"Rogan-Gladen true prevalence for panel with resampling — uncertain_panel_rogan_gladen","title":"Rogan-Gladen true prevalence for panel with resampling — uncertain_panel_rogan_gladen","text":"Uses resampling incorporate uncertainty sensitivity specificity estimate true prevalence given value apparent prevalence.","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/uncertain_panel_rogan_gladen.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Rogan-Gladen true prevalence for panel with resampling — uncertain_panel_rogan_gladen","text":"","code":"uncertain_panel_rogan_gladen(   panel_pos_obs,   panel_n_obs,   pos_obs,   n_obs,   false_pos_controls = NULL,   n_controls = NULL,   false_neg_diseased = NULL,   n_diseased = NULL,   ...,   sens = sens_prior(),   spec = spec_prior(),   confint = 0.95,   samples = 1000 )"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/uncertain_panel_rogan_gladen.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Rogan-Gladen true prevalence for panel with resampling — uncertain_panel_rogan_gladen","text":"panel_pos_obs number positive observations given panel tests panel_n_obs number observations component test pos_obs number positive observations given test n_obs number observations given test false_pos_controls number positives appeared specificity disease-free control group. definition false positives. (1-specificity)*n_controls n_controls number controls specificity disease-free control group. false_neg_diseased number negatives appeared sensitivity confirmed disease group. definition false negatives. (1-sensitivity)*n_diseased n_diseased number confirmed disease cases sensitivity control group. ... Arguments passed uncertain_rogan_gladen fmt sprintf formatting string accepting 3 numbers seed set seed reproducibility sens prior sensitivity test beta_dist. spec prior specificity test beta_dist. confint confidence interval limits samples number fo random draws sensitivity specificity","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/uncertain_panel_rogan_gladen.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Rogan-Gladen true prevalence for panel with resampling — uncertain_panel_rogan_gladen","text":"expected value apparent prevalence","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/uncertain_panel_rogan_gladen.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Rogan-Gladen true prevalence for panel with resampling — uncertain_panel_rogan_gladen","text":"vectorised","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/uncertain_panel_sens_estimator.html","id":null,"dir":"Reference","previous_headings":"","what":"Propagate component test sensitivity and specificity into panel specificity\nassuming a known set of observations of component apparent prevalence — uncertain_panel_sens_estimator","title":"Propagate component test sensitivity and specificity into panel specificity\nassuming a known set of observations of component apparent prevalence — uncertain_panel_sens_estimator","text":"Propagate component test sensitivity specificity panel specificity assuming known set observations component apparent prevalence","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/uncertain_panel_sens_estimator.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Propagate component test sensitivity and specificity into panel specificity\nassuming a known set of observations of component apparent prevalence — uncertain_panel_sens_estimator","text":"","code":"uncertain_panel_sens_estimator(   pos_obs,   n_obs,   false_pos_controls = NULL,   n_controls = NULL,   false_neg_diseased = NULL,   n_diseased = NULL,   ...,   sens = sens_prior(),   spec = spec_prior(),   samples = 1000,   fit_beta = FALSE )"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/uncertain_panel_sens_estimator.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Propagate component test sensitivity and specificity into panel specificity\nassuming a known set of observations of component apparent prevalence — uncertain_panel_sens_estimator","text":"pos_obs number positive observations given test n_obs number observations given test false_pos_controls number positives appeared specificity disease-free control group. definition false positives. (1-specificity)*n_controls n_controls number controls specificity disease-free control group. false_neg_diseased number negatives appeared sensitivity confirmed disease group. definition false negatives. (1-sensitivity)*n_diseased n_diseased number confirmed disease cases sensitivity control group. ... used sens prior sensitivity test beta_dist. spec prior specificity test beta_dist. samples number fo random draws sensitivity specificity fit_beta return result beta_dist object?","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/uncertain_panel_sens_estimator.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Propagate component test sensitivity and specificity into panel specificity\nassuming a known set of observations of component apparent prevalence — uncertain_panel_sens_estimator","text":"vector possible sensitivity values","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/uncertain_panel_sens_estimator.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Propagate component test sensitivity and specificity into panel specificity\nassuming a known set of observations of component apparent prevalence — uncertain_panel_sens_estimator","text":"","code":"uncertain_panel_sens_estimator(   pos_obs = c(30,10,20,10,5), n_obs=1000,   false_pos_controls = c(20,15,15,15,15), n_controls = c(800,800,800,800,800),   false_neg_diseased = c(20,25,20,20,15), n_diseased = c(100,100,100,100,100),   fit_beta = TRUE) #> 0.828 [0.664–0.936] (N=28.68)"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/uncertain_panel_spec.html","id":null,"dir":"Reference","previous_headings":"","what":"Propagate component test specificity into panel specificity — uncertain_panel_spec","title":"Propagate component test specificity into panel specificity — uncertain_panel_spec","text":"Propagate component test specificity panel specificity","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/uncertain_panel_spec.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Propagate component test specificity into panel specificity — uncertain_panel_spec","text":"","code":"uncertain_panel_spec(   false_pos_controls = NULL,   n_controls = NULL,   ...,   spec = spec_prior(),   samples = 1000,   na.rm = FALSE,   fit_beta = FALSE )"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/uncertain_panel_spec.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Propagate component test specificity into panel specificity — uncertain_panel_spec","text":"false_pos_controls number positives appeared specificity disease-free control group. definition false positives. (1-specificity)*n_controls n_controls number controls specificity disease-free control group. ... used spec prior specificity test beta_dist. samples number fo random draws sensitivity specificity na.rm remove missing values fit_beta return result beta_dist object?","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/uncertain_panel_spec.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Propagate component test specificity into panel specificity — uncertain_panel_spec","text":"vector possible specificities panel fitted beta_dist","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/uncertain_panel_spec.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Propagate component test specificity into panel specificity — uncertain_panel_spec","text":"","code":"uncertain_panel_spec(c(2,3,4,2,2), c(800,800,800,800,800), fit_beta=TRUE) #> 0.984 [0.974–0.991] (N=777.44)"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/uncertain_rogan_gladen.html","id":null,"dir":"Reference","previous_headings":"","what":"True prevalence from apparent prevalence with uncertainty — uncertain_rogan_gladen","title":"True prevalence from apparent prevalence with uncertainty — uncertain_rogan_gladen","text":"Uses resampling incorporate uncertainty sensitivity specificity estimate true prevalence given value apparent prevalence.","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/uncertain_rogan_gladen.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"True prevalence from apparent prevalence with uncertainty — uncertain_rogan_gladen","text":"","code":"uncertain_rogan_gladen(   pos_obs,   n_obs,   false_pos_controls = NULL,   n_controls = NULL,   false_neg_diseased = NULL,   n_diseased = NULL,   ...,   spec = spec_prior(),   sens = sens_prior(),   samples = 1000,   confint = 0.95,   fmt = \"%1.2f%% [%1.2f%% — %1.2f%%]\",   seed = NA )"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/uncertain_rogan_gladen.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"True prevalence from apparent prevalence with uncertainty — uncertain_rogan_gladen","text":"pos_obs number positive observations given test n_obs number observations given test false_pos_controls number positives appeared specificity disease-free control group. definition false positives. (1-specificity)*n_controls n_controls number controls specificity disease-free control group. false_neg_diseased number negatives appeared sensitivity confirmed disease group. definition false negatives. (1-sensitivity)*n_diseased n_diseased number confirmed disease cases sensitivity control group. ... used spec prior specificity test beta_dist. sens prior sensitivity test beta_dist. samples number fo random draws sensitivity specificity confint confidence interval limits fmt sprintf formatting string accepting 3 numbers seed set seed reproducibility prefix column name prefix","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/uncertain_rogan_gladen.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"True prevalence from apparent prevalence with uncertainty — uncertain_rogan_gladen","text":"expected value apparent prevalence","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/uncertain_rogan_gladen.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"True prevalence from apparent prevalence with uncertainty — uncertain_rogan_gladen","text":"","code":"uncertain_rogan_gladen(   pos_obs = 20, n_obs = 1000,    false_pos_controls = 10, n_controls = 800,    false_neg_diseased = 20, n_diseased = 100) #> # A tibble: 1 × 13 #>   prevalence.median prevalence.lower prevalence.upper prevalence.label      #>               <dbl>            <dbl>            <dbl> <chr>                 #> 1            0.0102                0           0.0180 1.02% [0.00% — 1.80%] #> # ℹ 9 more variables: spec.median <dbl>, spec.lower <dbl>, spec.upper <dbl>, #> #   spec.label <chr>, sens.median <dbl>, sens.lower <dbl>, sens.upper <dbl>, #> #   sens.label <chr>, prevalence.method <chr>    uncertain_rogan_gladen(   pos_obs = 5, n_obs = 1000,    sens = beta_dist(0.75,n=200),    spec = beta_dist(0.9975, n=800)) #> Error in beta_dist(0.75, n = 200): additional parameters detected to `beta_dist`: all parameters must be named  uncertain_rogan_gladen(   pos_obs = c(5,10), n_obs = c(1000,1000),    false_pos_controls = c(2,1), n_controls = c(800,800),    false_neg_diseased = c(25,20),n_diseased = c(100,100)) #> # A tibble: 2 × 13 #>   prevalence.median prevalence.lower prevalence.upper prevalence.label      #>               <dbl>            <dbl>            <dbl> <chr>                 #> 1           0.00373          0                0.00649 0.37% [0.00% — 0.65%] #> 2           0.0114           0.00714          0.0133  1.14% [0.71% — 1.33%] #> # ℹ 9 more variables: spec.median <dbl>, spec.lower <dbl>, spec.upper <dbl>, #> #   spec.label <chr>, sens.median <dbl>, sens.lower <dbl>, sens.upper <dbl>, #> #   sens.label <chr>, prevalence.method <chr>"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/underestimation_threshold.html","id":null,"dir":"Reference","previous_headings":"","what":"Test underestimation limit — underestimation_threshold","title":"Test underestimation limit — underestimation_threshold","text":"given sensitivity specificity give critical threshold test error introduces underestimation rather estimation","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/underestimation_threshold.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Test underestimation limit — underestimation_threshold","text":"","code":"underestimation_threshold(sens, spec)"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/underestimation_threshold.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Test underestimation limit — underestimation_threshold","text":"sens sensitivity test spec specificity test","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/underestimation_threshold.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Test underestimation limit — underestimation_threshold","text":"value apparent prevalence equals true prevalence","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/underestimation_threshold.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Test underestimation limit — underestimation_threshold","text":"","code":"tmp1 = underestimation_threshold(0.75, 0.97) tmp2 = rogan_gladen(tmp1, 0.75, 0.97) if (abs(tmp1-tmp2) > 0.0000001) stop(\"error\")"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/uniform_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"A uniform prior — uniform_prior","title":"A uniform prior — uniform_prior","text":"uniform prior","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/uniform_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A uniform prior — uniform_prior","text":"","code":"uniform_prior()"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/uniform_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A uniform prior — uniform_prior","text":"beta_dist","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/update_posterior.beta_dist.html","id":null,"dir":"Reference","previous_headings":"","what":"Update the posterior of a beta_dist — update_posterior.beta_dist","title":"Update the posterior of a beta_dist — update_posterior.beta_dist","text":"Update posterior beta_dist","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/update_posterior.beta_dist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Update the posterior of a beta_dist — update_posterior.beta_dist","text":"","code":"# S3 method for beta_dist update_posterior(x, ..., pos = NULL, neg = NULL, n = NULL)"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/update_posterior.beta_dist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Update the posterior of a beta_dist — update_posterior.beta_dist","text":"x beta_dist beta_dist_list acting prior ... used pos positive observation(s) neg negative observation(s) n number observations","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/update_posterior.beta_dist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Update the posterior of a beta_dist — update_posterior.beta_dist","text":"new beta_dist o beta_dist_list","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/update_posterior.beta_dist.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Update the posterior of a beta_dist — update_posterior.beta_dist","text":"","code":"update_posterior(beta_dist(shape1=1,shape2=1), neg=10, n=30) #> 0.660 [0.486–0.808] (N=32.00)"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/update_posterior.beta_dist_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Update the posterior of a beta_dist — update_posterior.beta_dist_list","title":"Update the posterior of a beta_dist — update_posterior.beta_dist_list","text":"Update posterior beta_dist","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/update_posterior.beta_dist_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Update the posterior of a beta_dist — update_posterior.beta_dist_list","text":"","code":"# S3 method for beta_dist_list update_posterior(x, ..., pos = NULL, neg = NULL, n = NULL)"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/update_posterior.beta_dist_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Update the posterior of a beta_dist — update_posterior.beta_dist_list","text":"x beta_dist beta_dist_list acting prior ... used pos positive observation(s) neg negative observation(s) n number observations","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/update_posterior.beta_dist_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Update the posterior of a beta_dist — update_posterior.beta_dist_list","text":"new beta_dist o beta_dist_list","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/update_posterior.beta_dist_list.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Update the posterior of a beta_dist — update_posterior.beta_dist_list","text":"","code":"update_posterior(beta_dist(shape1=1,shape2=1), neg=10, n=30) #> 0.660 [0.486–0.808] (N=32.00)"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/update_posterior.html","id":null,"dir":"Reference","previous_headings":"","what":"Update the posterior of a beta_dist — update_posterior","title":"Update the posterior of a beta_dist — update_posterior","text":"Update posterior beta_dist","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/update_posterior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Update the posterior of a beta_dist — update_posterior","text":"","code":"update_posterior(x, ..., pos = NULL, neg = NULL, n = NULL)"},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/update_posterior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Update the posterior of a beta_dist — update_posterior","text":"x beta_dist beta_dist_list acting prior ... used pos positive observation(s) neg negative observation(s) n number observations","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/update_posterior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Update the posterior of a beta_dist — update_posterior","text":"new beta_dist o beta_dist_list","code":""},{"path":"https://bristol-vaccine-centre.github.io/testerror/reference/update_posterior.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Update the posterior of a beta_dist — update_posterior","text":"","code":"update_posterior(beta_dist(shape1=1,shape2=1), neg=10, n=30) #> 0.660 [0.486–0.808] (N=32.00)"}]
